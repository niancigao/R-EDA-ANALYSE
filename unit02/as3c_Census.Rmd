---
title: "AS2-3: ç¾åœ‹äººå£æ™®æŸ¥è³‡æ–™"
author: "Group-00"
date: "`r Sys.time()`"
output: 
  html_document:
    highlight: pygments
    theme: flatly
    css: ../etc/style.css
---

```{r echo=F, results='hide', message=FALSE, warning=FALSE}
# Installation, setup & formatting. Do not modify this code chunk.  
rm(list=ls(all=T))
knitr::opts_chunk$set(comment = NA)
knitr::opts_knit$set(global.par = TRUE)
par(cex=0.8); options(scipen=20, digits=4, width=90)
if(!require(pacman)) install.packages("pacman")
pacman::p_load(dplyr)
```
<br><br>

The major data is in `data/MetroAreaCodes.csv`. We read it into a data frame `D`.
```{r}
D = read.csv("data/CPSData.csv")
```

`D` ä¹‹ä¸­æ¯ä¸€ç­†ç´€éŒ„æ˜¯ä¸€å€‹å—æ¸¬å°è±¡ï¼Œæ¯ä¸€å€‹æ¬„ä½æ˜¯ä¸€å€‹èª¿æŸ¥å•å·é¡Œé …ï¼š

+ `PeopleInHousehold`: å—è¨ªè€…å®¶åº­ä¸­çš„äººæ•¸ã€‚
+ `Region`: å—è¨ªè€…å±…ä½çš„äººå£æ™®æŸ¥å€åŸŸã€‚
+ `State`: å—è¨ªè€…å±…ä½çš„å·ã€‚
+ `MetroAreaCode`: éƒ½æœƒå€ä»£ç¢¼ï¼Œå¦‚å—è¨ªè€…ä¸ä½éƒ½æœƒå€ï¼Œå‰‡ç‚ºNAï¼›å¾ä»£ç¢¼åˆ°éƒ½æœƒå€åç¨±çš„å°æ‡‰åœ¨`MetroAreaCodes.csv`ä¸­æä¾›ã€‚
+ `Age`: å—è¨ªè€…çš„å¹´é½¡ï¼Œä»¥å¹´ç‚ºå–®ä½ã€‚ 80ä»£è¡¨80-84æ­²çš„äººï¼Œ85ä»£è¡¨85æ­²åŠä»¥ä¸Šçš„äººã€‚
+ `Married`: å—è¨ªè€…çš„å©šå§»ç‹€æ³ã€‚
+ `Sex`: å—è¨ªè€…çš„æ€§åˆ¥ã€‚
+ `Education`: å—è¨ªè€…ç²å¾—çš„æœ€é«˜æ•™è‚²ç¨‹åº¦ã€‚
+ `Race`: å—è¨ªè€…çš„ç¨®æ—ã€‚
+ `Hispanic`: å—è¨ªè€…æ˜¯å¦å±¬æ–¼è¥¿ç­ç‰™è£”ã€‚
+ `CountryOfBirthcode`: è­˜åˆ¥å—è¨ªè€…å‡ºç”Ÿåœ‹å®¶çš„ä»£ç¢¼ã€‚å¾ä»£ç¢¼åˆ°åœ‹å®¶åç¨±çš„æ˜ å°„åœ¨CountryCodes.csvæ–‡ä»¶ä¸­æä¾›ã€‚
+ `Citizenship`: å—è¨ªè€…çš„å…¬æ°‘èº«ä»½ã€‚
+ `EmploymentStatus`: å—è¨ªè€…çš„å°±æ¥­ç‹€æ³ã€‚
+ `Industry`: å—è¨ªè€…çš„å°±æ¥­è¡Œæ¥­ï¼ˆåƒ…åœ¨å—åƒ±çš„æƒ…æ³ä¸‹å¯ç”¨ï¼‰ã€‚

<br>

ğŸŒ· é€™ä»½ä½œæ¥­çš„å­¸ç¿’é‡é»æ˜¯ï¼š 

+ ç¼ºé … (`NA`) çš„è§€å¿µå’Œè™•ç†æ–¹æ³•
+ è³‡æ–™è¡¨æ ¼(data frame)çš„åˆä½µ

<br>

```{r}
summary(D)
```
In the `summary` we can see that there are 34,238 `NA`'s in `MetroAreaCode`.  Yet be careful ...

ğŸŒ· `summary` does not shows the numbers of `NA` in the character columns.

The best way to examine `NA` in a data frame is to pipe `is.na()` into `colSums()`.
```{r}
is.na(D) %>% colSums
```
now we see there are `NA`'s in `Married`, `Education`, `EmploymentStatus` and `Industry`. In the case of census, `NA` may occur when question items are ...

+ not answered
+ answered improperly 
+ not applicable to the respondents

<br><br>

###  Section-1 Loading and Summarizing the Dataset

__Â§ 1.1__ How many interviewees are in the dataset?
```{r}
A = read.csv("data/CPSData.csv")

MetroAreaMap = read.csv('data/MetroAreaCodes.csv')
#MetroAreaCode: éƒ½æœƒå€ä»£ç¢¼ï¼Œå¦‚å—è¨ªè€…ä¸ä½éƒ½æœƒå€ï¼Œå‰‡ç‚ºNA
#å¾ä»£ç¢¼åˆ°éƒ½æœƒå€åç¨±çš„å°æ‡‰åœ¨MetroAreaCodes.csvä¸­æä¾›ã€‚

CountryMap = read.csv('data/CountryCodes.csv')
#CountryOfBirthcode: è­˜åˆ¥å—è¨ªè€…å‡ºç”Ÿåœ‹å®¶çš„ä»£ç¢¼ã€‚
#å¾ä»£ç¢¼åˆ°åœ‹å®¶åç¨±çš„æ˜ å°„åœ¨CountryCodes.csvæ–‡ä»¶ä¸­æä¾›ã€‚  

nrow(A)
```

__Â§ 1.2__ Among the interviewees with a value reported for the Industry variable, what is the most common industry of employment? Please enter the name exactly how you see it.
```{r}
#åœ¨ç‚ºè¡Œæ¥­è®Šé‡å ±å‘Šå€¼çš„å—è¨ªè€…ä¸­ï¼Œæœ€å¸¸è¦‹çš„å°±æ¥­è¡Œæ¥­æ˜¯ä»€éº¼ï¼Ÿè«‹æº–ç¢ºè¼¸å…¥æ‚¨æ‰€çœ‹åˆ°çš„åç¨±ã€‚
table(A$Industry) %>% sort %>% tail(1)
```

__Â§ 1.3__ Which state has the fewest interviewees?
```{r}
#å“ªå€‹å·çš„å—è¨ªè€…æœ€å°‘ï¼Ÿ
table(A$State) %>% sort %>% head(1)

```

Which state has the largest number of interviewees?
```{r}
#å“ªå€‹å·çš„å—è¨ªè€…äººæ•¸æœ€å¤šï¼Ÿ
table(A$State) %>% sort %>% tail(1)

```

__Â§ 1.4__ What proportion of interviewees are citizens of the United States?
```{r}
#å—è¨ªè€…ä¸­æœ‰å¤šå°‘æ˜¯ç¾åœ‹å…¬æ°‘ï¼Ÿ
e = table(A$Citizenship) %>% prop.table()
e[1]

```

__Â§ 1.5__ For which races are there at least 250 interviewees in the CPS dataset of Hispanic ethnicity? 
```{r}
#å“ªå€‹ç¸½æ—è£¡æœ‰è‡³å°‘250åè¥¿ç­ç‰™è£”
z = tapply(A$Hispanic,A$Race,sum) %>% sort
names(z)[z>=250]

```

<br><br> 


###  Section-2 Evaluating Missing Values

__Â§ 2.1__ Which variables have at least one interviewee with a missing (NA) value? 
```{r}
#å“ªäº›è®Šé‡è‡³å°‘æœ‰ä¸€ä½å—è¨ªè€…ç¼ºå¤± (NA) å€¼ï¼Ÿ
b = is.na(A) %>% colSums
names(b)[b>=1]

```

__Â§ 2.2__  Which statements below is the most accurate:

+ The Married variable being missing is related to the Region value for the interviewee.
+ The Married variable being missing is related to the Sex value for the interviewee.
+ The Married variable being missing is related to the Age value for the interviewee. 
+ The Married variable being missing is related to the Citizenship value for the interviewee.
+ The Married variable being missing is not related to the Region, Sex, Age, or Citizenship value for the interviewee.

```{r}
#ä»¥ä¸‹å“ªäº›èªªæ³•æœ€æº–ç¢º
#ç¼ºå°‘çš„å·²å©šè®Šé‡èˆ‡å—è¨ªè€…çš„å€åŸŸå€¼æœ‰é—œã€‚
#ç¼ºå°‘çš„å·²å©šè®Šé‡èˆ‡å—è¨ªè€…çš„æ€§åˆ¥å€¼æœ‰é—œã€‚
#ç¼ºå°‘çš„å·²å©šè®Šé‡èˆ‡å—è¨ªè€…çš„å¹´é½¡å€¼æœ‰é—œã€‚
#ç¼ºå°‘çš„å·²å©šè®Šé‡èˆ‡å—è¨ªè€…çš„å…¬æ°‘èº«ä»½å€¼æœ‰é—œã€‚
#ç¼ºå°‘çš„å·²å©šè®Šé‡èˆ‡å—è¨ªè€…çš„åœ°å€ã€æ€§åˆ¥ã€å¹´é½¡æˆ–å…¬æ°‘èº«ä»½å€¼ç„¡é—œã€‚

#å„å€åŸŸä¸­éºæ¼ä»¥å©šè®Šé‡æ•¸æ“šçš„æ¯”ä¾‹
tapply(is.na(A$Married),A$Region,mean)

#å„æ€§åˆ¥ä¸­éºæ¼ä»¥å©šè®Šé‡æ•¸æ“šçš„æ¯”ä¾‹
tapply(is.na(A$Married),A$Sex,mean)

#å„å¹´é½¡ä¸­éºæ¼ä»¥å©šè®Šé‡æ•¸æ“šçš„æ¯”ä¾‹
tapply(is.na(A$Married),A$Age,mean)

#å„å…¬æ°‘èº«ä»½ä¸­éºæ¼ä»¥å©šè®Šé‡æ•¸æ“šçš„æ¯”ä¾‹
tapply(is.na(A$Married),A$Citizenship,mean)


#å› ç‚ºmeanåšå‡ºä¾†çš„æ¯”ä¾‹ä¸æœƒå› ç‚ºæ¨£æœ¬æ•¸å¤§å°è€Œå½±éŸ¿åˆ¤æ–·ç›¸é—œæ€§çš„æ±ºç­–
#æ•¸å€¼çµ±ä¸€è½åœ¨0-1ä¹‹é–“å¥½æ¯”è¼ƒ

#ANS:ç¼ºå°‘çš„å·²å©šè®Šé‡èˆ‡å—è¨ªè€…çš„å¹´é½¡å€¼æœ‰é—œã€‚
#    å› ç‚ºæœªæ»¿15æ­²çš„å—è¨ªè€…ä¸é©ç”¨å·²å©šã€‚é€™ç¨®é¡å‹çš„â€œNAâ€ç³»çµ±åœ°ç™¼ç”Ÿã€‚å®ƒå€‘ä¸æ˜¯éš¨æ©Ÿçš„ã€‚

```

ğŸŒ» Married is not applicable for interviewees who is younger than 15 years old. This type of `NA` occurs systematically. They are not random.  

__Â§ 2.3__ How many states had all interviewees living in a non-metropolitan area (aka they have a missing `MetroAreaCode` value)? For this question, treat the District of Columbia as a state (even though it is not technically a state).
```{r}
#æœ‰å¤šå°‘å€‹å·çš„æ‰€æœ‰å—è¨ªè€…éƒ½å±…ä½åœ¨éå¤§éƒ½å¸‚å€ï¼ˆä¹Ÿå°±æ˜¯ä»–å€‘ç¼ºå°‘â€œMetroAreaCodeâ€å€¼ï¼‰ï¼Ÿ
#å°æ–¼é€™å€‹å•é¡Œï¼Œå°‡å“¥å€«æ¯”äºç‰¹å€è¦–ç‚ºä¸€å€‹å·ï¼ˆå³ä½¿å®ƒåœ¨æŠ€è¡“ä¸Šä¸æ˜¯ä¸€å€‹å·ï¼‰ã€‚

n = tapply(is.na(A$MetroAreaCode),A$State,mean) %>% sort
#names(n)[n==1]
length(names(n)[n==1])

#ç”¨æ¯”ä¾‹==1è¡¨ç¤º (éå¤§éƒ½æœƒå€/å·äººæ•¸) å…¨å·äººéƒ½å±…ä½åœ¨éå¤§éƒ½æœƒå€

```

How many states had all interviewees living in a metropolitan area? Again, treat the District of Columbia as a state.
```{r}
#æœ‰å¤šå°‘å€‹å·çš„æ‰€æœ‰å—è¨ªè€…éƒ½ä½åœ¨å¤§éƒ½å¸‚å€ï¼Ÿå†æ¬¡ï¼Œå°‡å“¥å€«æ¯”äºç‰¹å€è¦–ç‚ºä¸€å€‹å·ã€‚

n = tapply(is.na(A$MetroAreaCode),A$State,mean) %>% sort
#names(n)[n==0]
length(names(n)[n==0])

#ç”¨æ¯”ä¾‹==0è¡¨ç¤º (éå¤§éƒ½æœƒå€/å·äººæ•¸) åªè¦æ˜¯ä½åœ¨æ­¤å·çš„äººå…¨éƒ½ä¸å±…ä½åœ¨éå¤§éƒ½æœƒå€

```

__Â§ 2.4__ Which region of the United States has the largest proportion of interviewees living in a non-metropolitan area?
```{r}
#ç¾åœ‹å“ªå€‹åœ°å€çš„å—è¨ªè€…å±…ä½åœ¨éå¤§éƒ½å¸‚å€çš„æ¯”ä¾‹æœ€é«˜ï¼Ÿ

tapply(is.na(A$MetroAreaCode),A$Region,mean) %>% sort %>% tail(1)

#ç”¨æ¯”ä¾‹è¡¨ç¤º å„å€äººæ•¸ä¸­éå¤§éƒ½æœƒå€æœ‰å¤šå°‘äºº æ‰¾æœ€å¤§å€¼
```

__Â§ 2.5__ Which state has a proportion of interviewees living in a non-metropolitan area closest to 30%?
```{r}
#å“ªå€‹å·çš„å—è¨ªè€…å±…ä½åœ¨éå¤§éƒ½å¸‚å€çš„æ¯”ä¾‹æ¥è¿‘ 30%ï¼Ÿ
k = tapply(is.na(A$MetroAreaCode),A$State,mean) %>% sort
l = abs(k-0.3)
names(l)[l==min(l)]

#ç”¨meanæ‰¾å‡ºå„å·éå±…ä½åœ¨å¤§éƒ½å¸‚å€çš„æ¯”ä¾‹ï¼Œå†åˆ©ç”¨çµ•å°å€¼æ‰¾æ¯”ä¾‹è·Ÿ0.3ç›¸æ¸›æœ€å°(æœ€æ¥è¿‘)çš„å·

```

Which state has the largest proportion of non-metropolitan interviewees, ignoring states where all interviewees were non-metropolitan?
```{r}
#å“ªå€‹å·çš„ééƒ½å¸‚å—è¨ªè€…æ¯”ä¾‹æœ€å¤§ï¼Œå¿½ç•¥æ‰€æœ‰å—è¨ªè€…éƒ½æ˜¯ééƒ½å¸‚çš„å·ï¼Ÿ
n = tapply(is.na(A$MetroAreaCode),A$State,mean) %>% sort(decreasing = T)
u = length(names(n)[n==1])
p = n-1
h = p[-1:-u]
names(h)[h==max(h)]

#å…ˆæŠŠå·çš„ééƒ½å¸‚å—è¨ªè€…æ¯”ä¾‹ç”±å¤§åˆ°å°æ’åˆ—ï¼Œæ‰£æ‰æ¯”ä¾‹ç‚º1çš„å·ï¼Œæ‰¾å‡ºæœ€æ¥è¿‘0çš„å·

```

ğŸŒ» As we can see in the questions above, `NA`'s are not completely useless. Sometimes they carry useful information. 

<br><br> 

###  Section-3 Integrating Metropolitan Area Data

In this exercise, we have two more data files 

+ `data/MetroAreaCodes.csv` maps `D$MetroAreaCode` to the names of the Metro Area's
+ `data/CountryCodes.csv` maps `D$CountryCode` to the names of the Countries

```{r}
metro = read.csv("data/MetroAreaCodes.csv")
country = read.csv("data/CountryCodes.csv")
```

__Â§ 3.1__ How many observations (codes for metropolitan areas) are there in `MetroAreaMap`?
```{r}
# è¨ˆç®—metroè³‡æ–™é›†çš„è³‡æ–™ç­†æ•¸
nrow(metro)

```

How many observations (codes for countries) are there in CountryMap?
```{r}
# è¨ˆç®—countryè³‡æ–™é›†çš„è³‡æ–™ç­†æ•¸
nrow(country)

```

ğŸŒ» `merge(x, y, by.x, by.y, all.x, all.y)` merges two data frames `x` and `y`

+ `by.x` and `by.y` specify the merging keys in `x` and `y` respectively.
+ `all.x` and `all.y` specify whether all rows in `x` and `y` should be kept. The defaults are `FALSE` which implies rows that do not match are removed. When set to `TRUE`, the unmatched rows stay with the merged columns set to `NA`.

__Â§ 3.2__ What is the name of the variable that was added to the data frame by the merge() operation?
```{r}
D = merge(D, metro, by.x="MetroAreaCode", by.y="Code", all.x=TRUE)
# DataåŠ å…¥äº†MetroAreaè®Šæ•¸

```

How many interviewees have a missing value for the new metropolitan area variable?
```{r}
# è¨ˆç®—è®Šæ•¸MetroAreaéºå¤±å€¼çš„æ•¸é‡
is.na(D$MetroArea) %>% sum()

```

__Â§ 3.3__ Which of the following metropolitan areas has the largest number of interviewees?
```{r}
# æ‰¾å‡ºå“ªå€‹åŸå¸‚çš„å—è¨ªè€…æœ€å¤š
table(D$MetroArea) %>% sort() %>% tail(1) %>% names()

```

__Â§ 3.4__ Which metropolitan area has the highest proportion of interviewees of Hispanic ethnicity?
```{r}
# å“ªå€‹åŸå¸‚æœ‰æœ€é«˜æ¯”ä¾‹çš„æ‹‰ä¸è£”äººç¨®
tapply(D$Hispanic == T, D$MetroArea, mean) %>% sort() %>% tail(1) %>% names()

```

__Â§ 3.5__ Determine the number of metropolitan areas in the United States from which at least 20% of interviewees are Asian.
```{r}
# æœ‰å¤šå°‘å€‹åŸå¸‚æœ‰è¶…éç™¾åˆ†ä¹‹20çš„äºæ´²äºº
sum(tapply(D$Race == "Asian", D$MetroArea, mean) > 0.2)

```

ğŸŒ» All mathematical and logical function return `NA` if there is any `NA` in their input vector(s). As an remedy, the `na.rm=TRUE` argument can exclude the `NA`'s from the input before calculation.    

__Â§ 3.6__  Passing `na.rm=TRUE` to the `tapply` function, determine which metropolitan area has the smallest proportion of interviewees who have received no high school diploma.
```{r}
# å“ªå€‹å¤§éƒ½å¸‚å€æ²’æœ‰ç²å¾—é«˜ä¸­æ–‡æ†‘çš„å—è¨ªè€…æ¯”ä¾‹æœ€å°ã€‚
# å°‡Eduationå’ŒMetroAreaæ¬„ä½ä¸­çš„éºå¤±å€¼åˆªé™¤ï¼Œå†æ‰¾å‡ºå“ªå€‹åŸå¸‚æ²’æœ‰é«˜ä¸­æ–‡æ†‘çš„æ¯”ä¾‹æœ€å°‘
tapply(D$Education == "No high school diploma", D$MetroArea, mean, na.rm = T) %>% 
  sort() %>% head(1) %>% names()

#å¦‚æœè¼¸å…¥å‘é‡ä¸­æœ‰ä»»ä½•â€œNAâ€ï¼Œæ‰€æœ‰æ•¸å­¸å’Œé‚è¼¯å‡½æ•¸éƒ½æœƒè¿”å›â€œNAâ€ã€‚
#ä½œç‚ºè£œæ•‘æªæ–½ï¼Œ`na.rm=TRUE` åƒæ•¸å¯ä»¥åœ¨è¨ˆç®—ä¹‹å‰å¾è¼¸å…¥ä¸­æ’é™¤ `NA`ã€‚

```

<br><br> 


###  Section-4 Integrating Country of Birth Data

__Â§ 4.1__ What is the name of the variable added to the CPS data frame by this merge operation?
```{r}
D = merge(D, country, by.x="CountryOfBirthCode", by.y="Code", all.x=TRUE) 
# å†å°‡Country of Birth Codeè³‡æ–™åˆä½µå…¥D
# åˆä½µå¾Œå¤šäº†Countryé€™å€‹è®Šæ•¸

```

How many interviewees have a missing value for the new metropolitan area variable?
```{r}
# ç”¨is.naå‡½æ•¸ä¾†æŸ¥çœ‹åœ¨metro areaé€™å€‹è®Šæ•¸ä¸­çš„ç¼ºå¤±å€¼æœ‰å¤šå°‘
# åœ¨metro areaé€™å€‹è®Šæ•¸ä¸­æœ‰34238ç¼ºå¤±å€¼
sum(is.na(D$MetroArea)) 

```

__Â§ 4.2__ Among all interviewees born outside of North America, which country was the most common place of birth?
```{r}
#åœ¨åŒ—ç¾ä»¥å¤–å‡ºç”Ÿçš„æ‰€æœ‰å—è¨ªè€…ä¸­ï¼Œå“ªå€‹åœ‹å®¶æ˜¯æœ€å¸¸è¦‹çš„å‡ºç”Ÿåœ°ï¼Ÿ
# ç”¨tableå‡½æ•¸åˆ—å‡ºéç¾è£”ä½†ä½åœ¨éƒ½æœƒå€çš„å—è¨ªè€…çš„å‡ºç”Ÿåœ‹ï¼Œä»¥éæ¸›æ–¹å¼æ’åºï¼Œåˆ—å‡ºå‰åå€‹åœ‹å®¶
# å‰åå€‹åœ‹å®¶åˆ†åˆ¥ç‚ºï¼šMexico, Philippines, India, China, Puerto Rico, El Salvador, Vietnam, Germany, Cuba, Canada

table(D$Country[D$Country!="United States"]) %>% sort(decreasing = T) %>% head(1)

```

__Â§ 4.3__ What proportion of the interviewees from the "New York-Northern New Jersey-Long Island, NY-NJ-PA" metropolitan area have a country of birth that is not the United States? 
```{r}
#ä¾†è‡ªâ€œç´ç´„-æ–°æ¾¤è¥¿å·åŒ—éƒ¨-é•·å³¶ï¼ŒNY-NJ-PAâ€å¤§éƒ½å¸‚å€çš„å—è¨ªè€…ä¸­æœ‰å¤šå¤§æ¯”ä¾‹çš„å‡ºç”Ÿåœ‹ä¸æ˜¯ç¾åœ‹ï¼Ÿ

# ç”¨tableå‡½æ•¸åˆ—å‡ºç¾è£”ä¸”å±…ä½åœ¨New York, Northern New Jersey, Long Island, NY-NJ-PAçš„å—è¨ªè€…ï¼Œçµæœç‚ºFalseçš„è¡¨ç¤ºéç¾è£”çš„æ¯”ç‡ï¼Œå³é¡Œç›®æƒ³è¦çš„ç­”æ¡ˆ
# 30.87 %

b = table(D$Country[D$MetroArea=="New York-Northern New Jersey-Long Island, NY-NJ-PA"]=="United States") %>% prop.table 
b['FALSE']

```

__Â§ 4.4__ Which metropolitan area has the largest number (note -- not proportion) of interviewees with a country of birth in India? 
```{r}
#å“ªå€‹å¤§éƒ½å¸‚å€çš„å‡ºç”Ÿåœ‹åœ¨å°åº¦çš„å—è¨ªè€…äººæ•¸æœ€å¤šï¼ˆæ³¨æ„ä¸æ˜¯æ¯”ä¾‹ï¼‰ï¼Ÿ

# ç”¨tapplyå‡½æ•¸ç®—å‡ºå°åº¦ç±ä¸”ç”Ÿæ´»åœ¨éƒ½æœƒå€çš„å—è¨ªè€…äººæ•¸ï¼Œå·²é™å†ªæ–¹å¼æ’åˆ—å‡ºæœ€å¤šå°åº¦ç±å±…ä½ä¹‹éƒ½æœƒå€
# Detroit-Warren-Livonia, MI æœ‰æœ€å¤šå°åº¦ç±å±…ä½

tapply(D$Country=="India", D$MetroArea, sum) %>% sort(decreasing=T) %>% head(1) 

```

In Brazil?
```{r}
# ç”¨tapplyå‡½æ•¸ç®—å‡ºå·´è¥¿ç±ä¸”ç”Ÿæ´»åœ¨éƒ½æœƒå€çš„å—è¨ªè€…äººæ•¸ï¼Œå·²é™å†ªæ–¹å¼æ’åˆ—å‡ºæœ€å¤šå·´è¥¿ç±å±…ä½ä¹‹éƒ½æœƒå€
# Boston-Cambridge-Quincy, MA-NHæœ‰æœ€å¤šå·´è¥¿ç±å±…ä½

tapply(D$Country=="Brazil", D$MetroArea, sum) %>% sort(decreasing=T) %>% head(1) 

```

In Somalia?
```{r}
# ç”¨tapplyå‡½æ•¸ç®—å‡ºç´¢ç‘ªåˆ©äºç±ä¸”ç”Ÿæ´»åœ¨éƒ½æœƒå€çš„å—è¨ªè€…äººæ•¸ï¼Œå·²é™å†ªæ–¹å¼æ’åˆ—å‡ºæœ€å¤šç´¢ç‘ªåˆ©äºç±å±…ä½ä¹‹éƒ½æœƒå€
# Phoenix-Mesa-Scottsdale, AZ & St. Cloud, MN æœ‰æœ€å¤šç´¢ç‘ªåˆ©äºç±å±…ä½

tapply(D$Country=="Somalia", D$MetroArea, sum) %>% sort(decreasing=T) %>% head(1) 

```

<br><br><br>
