---
title: UNIT2Cqaï¼šåˆ†é¡é‹ç®—èˆ‡æ¢ä»¶æ©Ÿç‡
author: ä¸­å±±å¤§å­¸ç®¡ç†å­¸é™¢ å“é›ç„¶
date: "`r Sys.time()`"
output: 
  html_document:
    highlight: pygments
    theme: spacelab
    css: ../etc/style.css
---

```{r echo=F, results='hide', message=FALSE, warning=FALSE}
# Basic installation, setup & formatting.  Do not modify this code chunk.  
rmarkdown::find_pandoc(version = '2.7.3')
rm(list=ls(all=T))
knitr::opts_chunk$set(comment = NA)
knitr::opts_knit$set(global.par = TRUE)
par(cex=0.8); options(scipen=20, digits=4, width=80)
if(!require(pacman)) install.packages("pacman")
pacman::p_load(magrittr)
```
<br>


ğŸŒ» `read.csv()` - è®€å–CSVï¼ˆé€—è™Ÿåˆ†éš”å€¼ï¼‰çš„æ–‡ä»¶
```{r}
D = read.csv("data/comics1.csv")
```

<br>

### 5. è¨ˆç®—æ•¸é‡èˆ‡æ¯”ç‡

##### 5.1  é‚è¼¯é‹ç®—å¼çš„æ•¸é‡èˆ‡æ¯”ç‡

ğŸŒ» ç”¨ `sum()` ä¾†è¨ˆç®—ä¸€å€‹é‚è¼¯å‘é‡è£¡é¢ `TRUE` çš„å€‹æ•¸ <br>
```{r}
sum(D$align == "Good")
```
<br>

ğŸŒ» ç”¨ `mean()` ä¾†è¨ˆç®—ä¸€å€‹é‚è¼¯å‘é‡è£¡é¢ `TRUE` çš„æ¯”ä¾‹ <br>
```{r}
mean(D$align == "Good")
```
<br>

##### 5.2 `table()` and `prop.table()`

ğŸŒ» `table()` åˆ—å‡ºä¸€å€‹å‘é‡è£¡å„ä¸åŒçš„å€¼å‡ºç¾çš„æ¬¡æ•¸ <br>
```{r}
table(D$align)
```
<br>

ğŸŒ» `prop.table()` å°‡è¨ˆæ•¸è½‰æ›æˆæ¯”ä¾‹ <br>
```{r}
table(D$align) %>% prop.table
```
<br>

å¦‚æœæˆ‘å€‘åœ¨`table()`ä¸­æ”¾å…¥å…©å€‹è®Šæ•¸ï¼Œæœƒç™¼ç”Ÿä»€éº¼äº‹å‘¢? <br>
```{r}
table(D$align, D$sex)
```
<br>

â“ CæŸ¥çœ‹`prop.table`çš„ç·šä¸Šèªªæ˜(F1)ï¼Œå®ƒçš„`margin`é€™å€‹åƒæ•¸çš„ä½œç”¨æ˜¯ä»€éº¼ï¼Ÿ <br>
â“ Check the online help of `prop.table`. What does argument `margin` works?

```{r}
table(D$align, D$sex) %>% prop.table
table(D$align, D$sex) %>% prop.table(1)
table(D$align, D$sex) %>% prop.table(2)
```

<br>
æˆ‘å€‘ä¾†ç·´ç¿’ä¸€ä¸‹, 

+ è³‡æ–™ä¸­æœ‰å¤šå°‘å€‹å£ç”·äºº â“ 
+ å£è§’è‰²ä¹‹ä¸­æœ‰å¤šå°‘æ¯”ç‡æ˜¯å¥³çš„ â“ 
+ å¥³æ€§ä¹‹ä¸­æœ‰å¤šå°‘æ¯”ç‡æ˜¯å£äºº â“ 

<br>
<span style="font-size:40px"> ğŸ† </span>
<span style="font-size:20px; font-family:'Arial Black'">Group Competition Round 1</span>
<br>

<span style="font-family:'Consolas'">
1. æˆ‘å€‘æœ‰å¤šå°‘å€‹å£äººè§’è‰²ï¼Ÿ  2915 <br>
2. æˆ‘å€‘æœ‰å¤šå°‘å€‹å£ç”·æ€§è§’è‰²ï¼Ÿ 2239 <br>
3. åœ¨æ‰€æœ‰è§’è‰²ç•¶ä¸­ï¼Œå£äººçš„æ¯”ä¾‹æ˜¯å¤šå°‘ï¼Ÿ 0.4021 <br>
4. åœ¨æ‰€æœ‰è§’è‰²ç•¶ä¸­ï¼Œå£ç”·æ€§è§’è‰²çš„æ¯”ä¾‹åˆæ˜¯å¤šå°‘å‘¢ï¼Ÿ 0.3088 <br>
5. åœ¨æ‰€æœ‰ç”·æ€§è§’è‰²ä¸­ï¼Œå£äººçš„æ¯”ä¾‹æ˜¯å¤šå°‘ï¼Ÿ 0.4590 <br>
6. åœ¨æ‰€æœ‰å£è§’è‰²ä¸­ï¼Œç”·ç”Ÿçš„æ¯”ä¾‹åˆæ˜¯å¤šå°‘å‘¢ï¼Ÿ 0.7681 <br>
7. åœ¨å“ªå€‹æ€§åˆ¥ç•¶ä¸­ï¼Œä¸­ç«‹çš„äººæ¯”è¼ƒå¤šï¼Ÿ Male <br>
8. å¥³æ€§çš„è§’è‰²æ¯”è¼ƒæœ‰å¯èƒ½æ˜¯ä¸­ç«‹çš„å—ï¼Ÿ TREU, 0.1821 > 0.1486 <br>
</span>

<br><br>


### 6. åˆ†é¡é‹ç®—èˆ‡æ¯”è¼ƒ

##### 6.1 åˆ†é¡é‹ç®—åŠŸèƒ½ `tapply()` 

ğŸŒ» `tapply(value, group, fun)` applies `fun` to `value` by each distinct `group`
```{r}
tapply(D$align == "Neutral", D$sex, sum)
```
æŒ‰æ€§åˆ¥è¨ˆç®—ä¸­ç«‹çš„äººæ•¸ 

```{r}
tapply(D$align == "Neutral", D$sex, mean)
```
æŒ‰æ€§åˆ¥è¨ˆç®—ä¸­ç«‹çš„æ¯”ç‡

<br>
æˆ‘å€‘ä¾†ç·´ç¿’ä¸€ä¸‹, 

æ¯ç¨®é ­é«®é¡è‰²ä¸­å¥³æ€§çš„æ¯”ä¾‹åˆ†åˆ¥æ˜¯å¤šå°‘ â“ 
```{r}
tapply(D$sex=="Female", D$hair, mean)
```

æ¯ç¨®é ­é«®é¡è‰²ä¹‹ä¸­ï¼Œå„æœ‰å¤šå°‘å¥³æ€§ â“ 
```{r}
tapply(D$sex=="Female", D$hair, sum)
```

<br>
<span style="font-size:40px"> ğŸ† </span>
<span style="font-size:20px; font-family:'Arial Black'">Group Competition Round 2</span>
<br><br>


1.åœ¨è—çœ¼ç›çš„è§’è‰²ä¸­ï¼Œç”·æ€§çš„æ¯”ä¾‹æ˜¯å¤šå°‘ï¼Ÿ 
```{r}
mean(D$sex[D$eye=="Blue"] == "Male")        # exactly 1 answer
tapply(D$sex=="Male", D$eye=="Blue", mean)  # comparing blue to the others
tapply(D$sex=="Male", D$eye, mean)          # comparing among all colors
table(D$eye, D$sex) %>% prop.table(1)       # comparing among all colors !!   
```

ğŸŒ· ä»¥ä¸Šå››ç¨®ä½œæ³•éƒ½å¯ä»¥å›ç­”ç›¸åŒçš„å•é¡Œï¼Œä½†æ˜¯ ...  

+ åˆ†ææœ¬èº«å°±æ˜¯æŠŠè³‡æ–™è®Šå°‘çš„éç¨‹ï¼Œè¼¸å‡ºè³‡æ–™ä¸¦ä¸æ˜¯è¶Šè©³ç´°è¶Šå¥½
+ ç”¢ç”Ÿè¡¨æ ¼é€šå¸¸æ˜¯ç‚ºäº†è¦åšåˆ†é¡æ¯”è¼ƒ
+ ç”¨å…©å€‹è®Šæ•¸åštable()æœƒç”¢ç”ŸäºŒç¶­çš„çŸ©é™£ï¼Œè¦åœ¨å“ªä¸€å€‹æ–¹å‘ä¸Šè½‰æˆæ¯”ä¾‹ã€å“ªä¸€å€‹æ–¹å‘ä¸Šé¢åšæ¯”è¼ƒå°±éœ€è¦å…ˆè€ƒæ…®æ¸…æ¥šã€‚ 

<br>

2.åœ¨ç”·æ€§è§’è‰²ä¸­ï¼Œè—çœ¼ç›è§’è‰²çš„æ•¸é‡æ˜¯å¤šå°‘ï¼Ÿ
```{r}
tapply(D$eye=="Blue", D$sex, sum)
```

3.ç”·æ€§çš„å­˜æ´»æ¯”ä¾‹æ˜¯å¤šå°‘ï¼Ÿ
```{r}
tapply(D$alive=="Living", D$sex, mean)
```

4.å“ªå€‹é™£ç‡Ÿ(å¥½äººé™£ç‡Ÿ or å£äººé™£ç‡Ÿ)æ¯”è¼ƒæœ‰å¯èƒ½å­˜æ´»ï¼Ÿ
Which align is more likely to stay alive?
```{r}
tapply(D$alive=="Living", D$align, mean)
```
<br>

##### 6.2 åˆ†é¡é‹ç®—èˆ‡æ¢ä»¶æ©Ÿç‡ - <z>å£äººçš„é•·ç›¸</z> 

5.åˆ—å‡ºåœ¨å„ç¨®é ­é«®é¡è‰²ä¹‹ä¸­å£äººçš„äººæ•¸ï¼Ÿ 
```{r}
tapply(D$align=="Bad", D$hair, sum) %>% sort
```

6.åˆ—å‡ºåœ¨å„ç¨®çœ¼ç›é¡è‰²ä¹‹ä¸­å£äººçš„æ¯”ä¾‹ï¼Ÿ 
```{r}
tapply(D$align=="Bad", D$eye, mean) %>% sort
```
<br><br>

##### 6.3 å£äººçš„é•·ç›¸ 

â“ å£äººæœ€æœ‰å¯èƒ½æœ‰å“ªä¸€ç¨®é ­é«®çœ¼ç›çµ„åˆå‘¢ï¼Ÿ <br>
â“ å“ªä¸€ç¨®é ­é«®çœ¼ç›çµ„åˆæœ€æœ‰å¯èƒ½æ˜¯å£äººå‘¢ï¼Ÿ <br>
â“ å¦‚æœæˆ‘å€‘æƒ³è¦æ ¹æ“šé•·ç›¸ä¾†è¾¨è­˜å£äººï¼Œæˆ‘å€‘æ‡‰è©²è¦å• ...

+ å£äººä¹‹ä¸­å“ªä¸€ç¨®çœ¼ç é¡è‰²çš„äººæ•¸æœ€å¤š 
+ å“ªä¸€ç¨®çœ¼ç é¡è‰²ä¹‹ä¸­å£äººçš„äººæ•¸æœ€å¤š
+ å£äººä¹‹ä¸­å“ªä¸€ç¨®çœ¼ç é¡è‰²çš„æ¯”ç‡æœ€é«˜ (`P[eye|bad]`) é‚„æ˜¯
+ å“ªä¸€ç¨®çœ¼ç é¡è‰²ä¹‹ä¸­å£äººçš„æ¯”ç‡æœ€é«˜ (`P[bad|eye]`) å‘¢ï¼Ÿ

<br>

ğŸŒ» å’Œ`table`ä¸€æ¨£ï¼Œ`tapply`ä¹Ÿå¯ä»¥æ¥å—å¤šæ–¼ä¸€å€‹åˆ†é¡è®Šæ•¸ 

æˆ‘å€‘å¯ä»¥ç®—å‡ºæ¯ä¸€ç¨®é ­é«®çœ¼ç›çµ„åˆä¹‹ä¸­å£äººçš„äººæ•¸ ...
```{r}
tapply(D$align=="Bad", list(eye=D$eye, hair=D$hair), sum) 
```

æ£•è‰²çœ¼ç›ã€é»‘è‰²é ­é«®çš„å£äººæ˜¯æœ€å¤šçš„ï¼Œæ‰€ä»¥æ£•çœ¼é»‘é«®çš„äººæ¯”è¼ƒæœ‰å¯èƒ½æ˜¯å£äººå— â“ 

æˆ‘å€‘ä¹Ÿå¯ä»¥ç®—å‡ºæ¯ä¸€ç¨®é ­é«®çœ¼ç›çµ„åˆä¹‹ä¸­å£äººçš„æ¯”ç‡
```{r}
tapply(D$align=="Bad", list(eye=D$eye, hair=D$hair), mean) 
```

æ‰€ä»¥ï¼Œå“ªä¸€ç¨®é•·ç›¸çš„äººï¼Œæœ€æœ‰å¯èƒ½æ˜¯å£äººå‘¢ â“ 


<br><br><p class="wwl">
<span style="font-size:16px">`r "\U1F4A1"` <b>å­¸ç¿’é‡é»</b></span><br>
åœ¨ä¸Šé¢çš„ç·´ç¿’ä¹‹ä¸­ï¼Œæˆ‘å€‘å­¸åˆ°äº† ... <br>
&emsp; â–  ç”¨ `table()` è¨ˆç®—æ•¸é‡<br>
&emsp; â–  ç”¨ `tapply()` åšåˆ†é¡é‹ç®—<br>
&emsp; â–  `table`, `tapply` å’Œ ç´¢å¼•çš„ç¶œåˆé‹ç”¨<br>
&emsp; â–  åˆ†é¡é‹ç®—èˆ‡æ¢ä»¶æ©Ÿç‡<br>
</p class="wwl"><br>



<br><br>


